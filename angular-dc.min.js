/**
 * angular-dc
 * @version v0.0.2 - 2014-06-01
 * @link https://github.com/tardyp/angular-dc
 * @author Tom Neyland <>
 * @license Apache License, http://www.opensource.org/licenses/Apache
 */
"use strict";angular.module("angularDc",[]).directive("dcChart",["$timeout",function(a){function b(a,b,e,f){var g=b[0],h=e.dcChart,i=e.dcChartGroup||void 0,j=dc[h],k=j(g,i),l=c(k),f=d(a,e,l);"options"in f&&(f=_.merge(f,f.options),f.options=void 0),"name"in f&&(a[f.name]=k,f.name=void 0),k.options(f);var m=_({preRender:f.onPreRender,postRender:f.onPostRender,preRedraw:f.onPreRedraw,postRedraw:f.onPostRedraw,filtered:f.onFiltered,zoomed:f.onZoomed}).omit(_.isUndefined);return m.each(function(a,b){k.on(b,a)}),_.isFunction(f.postSetupChart)&&f.postSetupChart(k,f),k}function c(a){return _(a).functions().extend(e).map(function(a){return"dc"+a.charAt(0).toUpperCase()+a.substring(1)}).value()}function d(a,b,c){return _(b.$attr).keys().intersection(c).map(function(c){var d=a.$eval(b[c]);return"dc"===c.substring(0,2)&&(c=c.charAt(2).toLowerCase()+c.substring(3)),[c,d]}).zipObject().value()}var e=["name","onFiltered","onPostRedraw","onPostRender","onPreRedraw","onPreRender","onZoomed","postSetupChart"];return{restrict:"A",link:function(c,d,e){var f=!1;c.dc=dc,c.d3=d3,c.DateTime=function(a,b,c,d,e,f){return new Date(a,b,c,d,e,f)},c.Date=function(a,b,c){return new Date(a,b,c)};var g=c.$watch(function(){var a=_(e.$attr).keys().filter(function(a){return"dc"===a.substring(0,2)&&"dcChart"!==a&&"dcChartGroup"!==a}).map(function(a){try{var b=c.$eval(e[a]);if(_.isUndefined(b))throw Error(e[a]+" is undefined");return b}catch(d){if(f)throw console.log("unable to eval"+a+":"+e[a]),d;return void 0}});return a.any(_.isUndefined)?void 0:a.value()},function(a){if(!_.isUndefined(a)){g();var f=b(c,d,e),h=angular.element(d[0].querySelector("a.reset"));h.on("click",function(){f.filterAll(),dc.redrawAll()}),h.attr("href","javascript:;"),h.css("display","none"),f.render()}});a(function(){f=!0},2e3)}}}]),angular.module("angularDc").directive("dcSelect",["$timeout",function(){return{restrict:"E",scope:{dcDimension:"=",allLabel:"@"},template:"<select class='form-control' ng-model='selectModel' ng-options='d.key for d in selectOptions'>",link:function(a){return a.$watch("dcDimension",function(b){var c,d;null!=b&&(d=dc.baseMixin({}),d.dimension(b),d.group(b),d._doRender=function(){},d._doRedraw=function(){},a.selectModel={key:a.allLabel},c=b.group().orderNatural().all(),a.selectOptions=[a.selectModel].concat(c))}),a.$watch("selectModel",function(b){null!=a.dcDimension&&(a.dcDimension.filter(null!==b&&b.key!==a.allLabel?function(a){return a===b.key}:null),dc.redrawAll())})}}}]);